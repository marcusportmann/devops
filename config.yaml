#
# VARIABLES
#
# The following variables influence the deployment and configuration of etcd:
#   etcd_cluster_name - The name of the etcd cluster, which influences the location and
#                       names of the private keys and certificates for the cluster.
#
# The following variables influence the deployment and configuration of Kubernetes:
#   k8s_cluster_name  - The name of the etcd cluster, which influences the location and
#                       names of the private keys and certificates for the cluster.
#   k8s_etcd_topology - The etcd topology for the Kubernetes cluster, which can be stacked
#                       or external, for an external etcd cluster.
#
#
# PROFILES
#
# Profiles are used to group a related set of hosts that need to be provisioned together,
# e.g., the hosts that form part of an etcd cluster, the hosts that form part of a
# Kubernetes cluster, the hosts that suport a set of integrated development tools, etc.
#

variables:
- name: etcd_cluster_name
  values:
  - local

- name: k8s_etcd_topology
  values:
  - stacked
- name: k8s_cluster_name
  values:
  - local
- name: k8s_cluster_domain
  values:
  - local.internal
#  - name: k8s_control_plane_endpoint
#    values:
#      - k8s-local-api.local
#  - name: k8s_kube_state_metrics_endpoint
#    values:
#      - k8s-local-metrics.local
- name: k8s_api_server_cert_sans
  values:
  - localhost
  - 127.0.0.1
  - k8s-local-api.local
- name: k8s_service_subnet
  values:
  - 10.254.0.0/16
- name: k8s_pod_subnet
  values:
  - 10.255.0.0/16  
- name: k8s_cni_provider
  values:
  - weave

- name: longhorn_enabled
  values:
  - true

- name: istio_enabled
  values:
  - true
- name: istio_profile
  values:
  - sds
- name: istio_grafana_enabled
  values:
  - false
- name: istio_kiali_enabled
  values:
  - false
- name: istio_prometheus_enabled
  values:
  - false
- name: istio_tracing_enabled
  values:
  - false
- name: istio_download_package
  values:
  - false

- name: operator_lifecycle_manager_enabled
  values:
  - true

- name: postgres_operator_enabled
  values:
  - true  

- name: prometheus_data_directory
  values:
  - /var/lib/prometheus

- name: topolvm_enabled
  values:
  - true  
- name: topolvm_volume_group
  values:
  - system  

profiles:
- name: devops
  hosts:
  - devops.local

- name: etcd_cluster
  hosts:
  - etcd-local-01.local
  - etcd-local-02.local
  - etcd-local-03.local

- name: k8s_minimal
  hosts:
  - k8s-local-m-01.local
  - k8s-local-w-01.local
  - k8s-local-w-02.local  
  - monitor.local

- name: k8s_full
  hosts:
  - k8s-local-m-01.local
  - k8s-local-m-02.local
  - k8s-local-m-03.local
  - k8s-local-w-01.local
  - k8s-local-w-02.local
  - k8s-local-w-03.local
  
- name: test-ubuntu1804
  hosts:
  - test-ubuntu1804.local

- name: test-centos77
  hosts:
  - test-centos77.local

- name: test-centos77
  hosts:
  - test-centos77.local

- name: test-centos80
  hosts:
  - test-centos80.local

hosts:
- name:                     etcd-local-01.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,etcd
  cpus:                     1
  memory:                   512
  hostname:                 etcd-local-01
  fqdn:                     etcd-local-01.local
  ip:                       192.168.184.41/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

- name:                     etcd-local-02.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,etcd
  cpus:                     1
  memory:                   512
  hostname:                 etcd-local-02
  fqdn:                     etcd-local-02.local
  ip:                       192.168.184.42/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

- name:                     etcd-local-03.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,etcd
  cpus:                     1
  memory:                   512
  hostname:                 etcd-local-03
  fqdn:                     etcd-local-03.local
  ip:                       192.168.184.43/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

- name:                     k8s-local-m-01.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,k8s_load_balancer,k8s_master
  cpus:                     2
  memory:                   2560
  hostname:                 k8s-local-m-01
  fqdn:                     k8s-local-m-01.local
  ip:                       192.168.184.51/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

- name:                     k8s-local-m-02.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,k8s_load_balancer,k8s_master
  cpus:                     2
  memory:                   2560
  hostname:                 k8s-local-m-02
  fqdn:                     k8s-local-m-02.local
  ip:                       192.168.184.52/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

- name:                     k8s-local-m-03.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,k8s_load_balancer,k8s_master
  cpus:                     2
  memory:                   2560
  hostname:                 k8s-local-m-03
  fqdn:                     k8s-local-m-03.local
  ip:                       192.168.184.53/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

- name:                     k8s-local-w-01.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,k8s_worker
  cpus:                     2
  memory:                   2048
  hostname:                 k8s-local-w-01
  fqdn:                     k8s-local-w-01.local
  ip:                       192.168.184.54/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

- name:                     k8s-local-w-02.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,k8s_worker
  cpus:                     2
  memory:                   2048
  hostname:                 k8s-local-w-02
  fqdn:                     k8s-local-w-02.local
  ip:                       192.168.184.55/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

- name:                     k8s-local-w-03.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,k8s_worker
  cpus:                     2
  memory:                   2048
  hostname:                 k8s-local-w-03
  fqdn:                     k8s-local-w-03.local
  ip:                       192.168.184.56/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

- name:                     monitor.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,prometheus,grafana
  cpus:                     2
  memory:                   1024
  hostname:                 monitor
  fqdn:                     monitor.local
  ip:                       192.168.184.30/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

- name:                     devops.local
  type:                     centos77
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored,k8s_load_balancer,k8s_master,prometheus,grafana
  cpus:                     3
  memory:                   6144
  hostname:                 devops
  fqdn:                     devops.local
  ip:                       192.168.184.50/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local

# monitored,k8s_load_balancer,k8s_master,prometheus,grafana

# monitored,k8s_load_balancer,k8s_master,prometheus,grafana



- name:                     test-ubuntu1804.local
  type:                     ubuntu1804
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored
  cpus:                     2
  memory:                   1024
  hostname:                 test-ubuntu1804
  fqdn:                     test-ubuntu1804.local
  ip:                       192.168.184.49/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local
  data_disk:                16107

- name:                     test-centos77.local
  type:                     centos77
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored
  cpus:                     2
  memory:                   1024
  hostname:                 test-centos77
  fqdn:                     test-centos77.local
  ip:                       192.168.184.49/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local
  data_disk:                16107  

- name:                     test-centos80.local
  type:                     centos80
  ansible_playbook:         ansible/devops.yaml
  ansible_groups:           monitored
  cpus:                     2
  memory:                   1024
  hostname:                 test-centos80
  fqdn:                     test-centos80.local
  ip:                       192.168.184.49/24
  network:                  192.168.184.0/24
  gateway:                  192.168.184.2
  dns_server:               192.168.184.2
  dns_search:               local
  data_disk:                16107  
  


