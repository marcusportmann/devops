---
#
# VARIABLES
#
# The following variables influence the deployment and configuration of etcd:
#   etcd_cluster_name - The name of the etcd cluster, which influences the location and
#                       names of the private keys and certificates for the cluster.
#
# The following variables influence the deployment and configuration of Kubernetes:
#   k8s_cluster_domain  - The name of the internal domain for the Kubernetes cluster.
#   k8s_cluster_name    - The name of the Kubernetes cluster, which influences the location
#                         and names of the private keys and certificates for the cluster.
#   k8s_etcd_topology   - The etcd topology for the Kubernetes cluster, which can be stacked
#                         or external, for an external etcd cluster.
#
#
# PROFILES
#
# Profiles are used to group a related set of hosts that need to be provisioned together,
# e.g., the hosts that form part of an etcd cluster, the hosts that form part of a
# Kubernetes cluster, the hosts that suport a set of integrated development tools, etc.
#

variables:
# ----------------------------------------------------------------------------------------
# Mandatory Configuration
# ----------------------------------------------------------------------------------------
- name: etcd_cluster_name
  values:
  - local

- name: k8s_cluster_domain
  values:
  - local.internal
- name: k8s_cluster_name
  values:
  - local

- name: kafka_cluster_name
  values:
  - local


# ----------------------------------------------------------------------------------------
# Optional Configuration
# ----------------------------------------------------------------------------------------
#- name: k8s_control_plane_endpoint
#  values:
#  - k8s-local-api.local
#- name: k8s_pod_subnet
#  values:
#  - 10.255.0.0/16
#- name: k8s_service_subnet
#  values:
#  - 10.254.0.0/16

#- name: k8s_operator_lifecycle_manager_enabled
#  values:
#  - false
- name: k8s_postgres_operator_enabled
  values:
  - true

- name: k8s_longhorn_enabled
  values:
  - true
- name: k8s_topolvm_enabled
  values:
  - true

- name: k8s_monitoring_enabled
  values:
  - true
- name: k8s_monitoring_elasticsearch_cluster_type
  values:
  - standalone
- name: k8s_monitoring_elasticsearch_persistent_volume_size
  values:
  - 10Gi
- name: k8s_monitoring_elasticsearch_persistent_volume_storage_class_name
  values:
  - default-local-storage
- name: k8s_monitoring_prometheus_persistent_volume_storage_class_name
  values:
  - default-local-storage
- name: k8s_monitoring_prometheus_alert_manager_persistent_volume_size
  values:
  - 2Gi
- name: k8s_monitoring_prometheus_server_persistent_volume_size
  values:
  - 10Gi

- name: k8s_istio_enabled
  values:
  - true


# ----------------------------------------------------------------------------------------
# Profiles
# ----------------------------------------------------------------------------------------
profiles:
- name: devops
  hosts:
  - devops.local

- name: etcd-minimal
  hosts:
  - etcd-local-01.local
  - monitor.local

- name: etcd-full
  hosts:
  - etcd-local-01.local
  - etcd-local-02.local
  - etcd-local-03.local

- name: k8s-minimal
  hosts:
  - k8s-local-api.local
  - k8s-local-m-01.local
  - k8s-local-w-01.local

- name: k8s-only-masters
  hosts:
  - k8s-local-api.local
  - k8s-local-m-01.local
  - k8s-local-m-02.local
  - k8s-local-m-03.local

- name: k8s-full
  hosts:
  - k8s-local-api.local
  - k8s-local-m-01.local
  - k8s-local-m-02.local
  - k8s-local-m-03.local
  - k8s-local-w-01.local
  - k8s-local-w-02.local
  - k8s-local-w-03.local

- name: kafka-minimal
  hosts:
  - kafka-local-01.local

- name: kafka-full
  hosts:
  - kafka-local-01.local
  - kafka-local-02.local
  - kafka-local-03.local

- name: test-all
  hosts:
  - test-centos7.local
  - test-centos8.local
  - test-centos81.local
  - test-ubuntu1804.local
  - test-ubuntu2004.local

- name: test-centos7
  hosts:
  - test-centos7.local

- name: test-centos7
  hosts:
  - test-centos7.local

- name: test-centos8
  hosts:
  - test-centos8.local

- name: test-centos81
  hosts:
  - test-centos81.local

- name: test-ubuntu1804
  hosts:
  - test-ubuntu1804.local

- name: test-ubuntu2004
  hosts:
  - test-ubuntu2004.local


# ----------------------------------------------------------------------------------------
# Hosts
# ----------------------------------------------------------------------------------------
hosts:
- name:               devops.local
  domain:             local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     k8s_master
  virtualbox:
    cpus:             4
    memory:           6144
    fqdn:             devops.local
    domain:           local
    ip:               192.168.184.60/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             4
    memory:           6144
    fqdn:             devops.local
    domain:           local
    ip:               192.168.184.60/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             4
    memory:           6144
    fqdn:             devops.local
    domain:           local
    ip:               192.168.0.60/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               etcd-local-01.local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     monitored,etcd
  virtualbox:
    cpus:             1
    memory:           512
    fqdn:             etcd-local-01.local
    domain:           local
    ip:               192.168.184.41/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             1
    memory:           512
    fqdn:             etcd-local-01.local
    domain:           local
    ip:               192.168.184.41/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             1
    memory:           512
    fqdn:             etcd-local-01.local
    domain:           local
    ip:               192.168.0.41/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               etcd-local-02.local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     monitored,etcd
  virtualbox:
    cpus:             1
    memory:           512
    fqdn:             etcd-local-02.local
    domain:           local
    ip:               192.168.184.42/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             1
    memory:           512
    fqdn:             etcd-local-02.local
    domain:           local
    ip:               192.168.184.42/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             1
    memory:           512
    fqdn:             etcd-local-02.local
    domain:           local
    ip:               192.168.0.42/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               etcd-local-03.local
  domain:             centos7
  type:               ubuntu2004
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     monitored,etcd
  virtualbox:
    cpus:             1
    memory:           512
    fqdn:             etcd-local-03.local
    domain:           local
    ip:               192.168.184.43/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             1
    memory:           512
    fqdn:             etcd-local-03.local
    domain:           local
    ip:               192.168.184.43/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             1
    memory:           512
    fqdn:             etcd-local-03.local
    domain:           local
    ip:               192.168.0.43/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               k8s-local-api.local
  domain:             local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     k8s_load_balancer
  virtualbox:
    cpus:             1
    memory:           512
    fqdn:             k8s-local-api.local
    domain:           local
    ip:               192.168.184.50/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             1
    memory:           512
    fqdn:             k8s-local-api.local
    domain:           local
    ip:               192.168.184.50/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             1
    memory:           1024
    fqdn:             k8s-local-api.local
    domain:           local
    ip:               192.168.0.50/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               k8s-local-m-01.local
  domain:             local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     k8s_master,k8s_components
  virtualbox:
    cpus:             2
    memory:           2048
    fqdn:             k8s-local-m-01.local
    domain:           local
    ip:               192.168.184.51/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           2048
    fqdn:             k8s-local-m-01.local
    domain:           local
    ip:               192.168.184.51/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           2048
    fqdn:             k8s-local-m-01.local
    domain:           local
    ip:               192.168.0.51/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               k8s-local-m-02.local
  domain:             local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     k8s_master,k8s_components
  virtualbox:
    cpus:             2
    memory:           2048
    fqdn:             k8s-local-m-02.local
    domain:           local
    ip:               192.168.184.52/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           2048
    fqdn:             k8s-local-m-02.local
    domain:           local
    ip:               192.168.184.52/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           2048
    fqdn:             k8s-local-m-02.local
    domain:           local
    ip:               192.168.0.52/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               k8s-local-m-03.local
  domain:             local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     k8s_master,k8s_components
  virtualbox:
    cpus:             2
    memory:           2048
    fqdn:             k8s-local-m-03.local
    domain:           local
    ip:               192.168.184.53/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           2048
    fqdn:             k8s-local-m-03.local
    domain:           local
    ip:               192.168.184.53/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           2048
    fqdn:             k8s-local-m-03.local
    domain:           local
    ip:               192.168.0.53/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               k8s-local-w-01.local
  domain:             local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     k8s_worker,k8s_components
  virtualbox:
    cpus:             2
    memory:           4096
    fqdn:             k8s-local-w-01.local
    domain:           local
    ip:               192.168.184.54/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           4096
    fqdn:             k8s-local-w-01.local
    domain:           local
    ip:               192.168.184.54/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           4096
    data_disk:        40960
    fqdn:             k8s-local-w-01.local
    domain:           local
    ip:               192.168.0.54/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               k8s-local-w-02.local
  domain:             local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     k8s_worker,k8s_components
  virtualbox:
    cpus:             2
    memory:           4096
    fqdn:             k8s-local-w-02.local
    domain:           local
    ip:               192.168.184.55/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           4096
    fqdn:             k8s-local-w-02.local
    domain:           local
    ip:               192.168.184.55/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           4096
    data_disk:        40960
    fqdn:             k8s-local-w-02.local
    domain:           local
    ip:               192.168.0.55/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               k8s-local-w-03.local
  domain:             local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     k8s_worker,k8s_components
  virtualbox:
    cpus:             2
    memory:           4096
    fqdn:             k8s-local-w-03.local
    domain:           local
    ip:               192.168.184.56/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           4096
    fqdn:             k8s-local-w-03.local
    domain:           local
    ip:               192.168.184.56/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           4096
    data_disk:        40960
    fqdn:             k8s-local-w-03.local
    domain:           local
    ip:               192.168.0.56/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               kafka-local-01.local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     kafka_zookeeper,kafka_server
  virtualbox:
    cpus:             2
    memory:           1536
    data_disk:        10240
    fqdn:             kafka-local-01.local
    domain:           local
    ip:               192.168.184.65/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           1536
    data_disk:        10240
    fqdn:             kafka-local-01.local
    domain:           local
    ip:               192.168.184.65/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           2560
    data_disk:        40960
    fqdn:             kafka-local-01.local
    domain:           local
    ip:               192.168.0.65/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               kafka-local-02.local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     kafka_zookeeper,kafka_server
  virtualbox:
    cpus:             2
    memory:           1536
    data_disk:        10240
    fqdn:             kafka-local-02.local
    domain:           local
    ip:               192.168.184.66/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           1536
    data_disk:        10240
    fqdn:             kafka-local-02.local
    domain:           local
    ip:               192.168.184.66/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           2560
    data_disk:        40960
    fqdn:             kafka-local-02.local
    domain:           local
    ip:               192.168.0.66/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               kafka-local-03.local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     kafka_zookeeper,kafka_server
  virtualbox:
    cpus:             2
    memory:           1536
    data_disk:        10240
    fqdn:             kafka-local-03.local
    domain:           local
    ip:               192.168.184.67/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           1536
    data_disk:        10240
    fqdn:             kafka-local-03.local
    domain:           local
    ip:               192.168.184.67/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           2560
    data_disk:        40960
    fqdn:             kafka-local-03.local
    domain:           local
    ip:               192.168.0.67/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               monitor.local
  domain:             local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     monitored,prometheus,grafana
  virtualbox:
    cpus:             1
    memory:           1024
    fqdn:             monitor.local
    domain:           local
    ip:               192.168.184.30/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             1
    memory:           1024
    fqdn:             monitor.local
    domain:           local
    ip:               192.168.184.30/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             1
    memory:           1024
    fqdn:             monitor.local
    domain:           local
    ip:               192.168.0.30/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               test-centos7.local
  domain:             local
  type:               centos7
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     monitored
  virtualbox:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-centos7.local
    domain:           local
    ip:               192.168.184.49/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-centos7.local
    domain:           local
    ip:               192.168.184.49/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           1024
    #data_disk:        4096
    fqdn:             test-centos7.local
    domain:           local
    ip:               192.168.0.49/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               test-centos8.local
  domain:             local
  type:               centos8
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     monitored
  virtualbox:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-centos8.local
    domain:           local
    ip:               192.168.184.48/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_desktop:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-centos8.local
    domain:           local
    ip:               192.168.184.48/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2
  vmware_esxi:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-centos8.local
    domain:           local
    ip:               192.168.184.48/24
    gateway:          192.168.184.2
    dns_server:       192.168.184.2

- name:               test-ubuntu1804.local
  domain:             local
  type:               ubuntu1804
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     monitored
  virtualbox:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-ubuntu1804.local
    domain:           local
    ip:               192.168.184.45/24
    gateway:          192.168.184.1
    dns_server:       192.168.184.1
  vmware_desktop:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-ubuntu1804.local
    domain:           local
    ip:               192.168.184.45/24
    gateway:          192.168.184.1
    dns_server:       192.168.184.1
  vmware_esxi:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-ubuntu1804.local
    domain:           local
    ip:               192.168.0.45/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

- name:               test-ubuntu2004.local
  domain:             local
  type:               ubuntu2004
  ansible_playbook:   ansible/devops.yaml
  ansible_groups:     monitored,prometheus,grafana
  virtualbox:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-ubuntu2004.local
    domain:           local
    ip:               192.168.184.44/24
    gateway:          192.168.184.1
    dns_server:       192.168.184.1
  vmware_desktop:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-ubuntu2004.local
    domain:           local
    ip:               192.168.184.44/24
    gateway:          192.168.184.1
    dns_server:       192.168.184.1
  vmware_esxi:
    cpus:             2
    memory:           1024
    data_disk:        4096
    fqdn:             test-ubuntu2004.local
    domain:           local
    ip:               192.168.0.44/24
    gateway:          192.168.0.1
    dns_server:       192.168.0.1

